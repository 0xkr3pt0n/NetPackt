{% extends "core/dashboard.html" %}

{%load static%}
{%block title%}Scans{%endblock%}
{%block headattrs%}<link rel="stylesheet" href="{%static 'discover.css'%}" />{%endblock%}
{%block dashboard_content%}
<main>
    <h1>Host discovery</h1>

    <form method="post" action="{% url 'discover' %}">
        {% csrf_token %}
        <label for="target_subnet">Target Subnet(EX:192.168.1.0/24):</label>
        <input type="text" name="target_subnet" pattern="^(?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]?[0-9]\.){2}(?:25[0-5]|2[0-4][0-9]|[0-1]?[0-9]?[0-9])\.0/24$" value="{{ target_subnet }}" required>
        <br>
        <label for="exclude_ips">Excluded IPs (comma-separated Ex:192.168.1.1,192.168.1.2):</label>
        <input type="text" name="exclude_ips" pattern="^(\b(?:\d{1,3}\.){3}\d{1,3}\b)(,\s*\b(?:\d{1,3}\.){3}\d{1,3}\b)*$" value="{{ exclude_ips }}">
        <br>
        <label for="output_file">Output File:</label>
        <input type="text" name="output_file" value="{{ output_file }}">
        <br>
        <button type="submit">Scan</button>
    </form>

    {% if error_message %}
        <p style="color: red;">{{ error_message }}</p>
    {% endif %}

    {% if results %}
        <h2>Results</h2>
        <ul>
            {% for result in results %}
                <li>
                    IP: {{ result.IP }}, MAC: {{ result.MAC }}, Vendor: {{ result.Vendor }}
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <h4>No live hosts</h4>
    {% endif %}
</main>
{%endblock%}