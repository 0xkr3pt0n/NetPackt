{% extends "core/dashboard.html" %}

{%load static%}
{%block title%}Scans{%endblock%}
{%block headattrs%}<link rel="stylesheet" href="{%static 'discover.css'%}" />{%endblock%}
{%block dashboard_content%}
<main>
    <h1>Host discovery</h1>

    <form method="post" action="{% url 'scan_network' %}">
        {% csrf_token %}
        <label for="target_subnet">Target Subnet:</label>
        <input type="text" name="target_subnet" value="{{ target_subnet }}" required>
        <br>
        <label for="exclude_ips">Excluded IPs (comma-separated):</label>
        <input type="text" name="exclude_ips" value="{{ exclude_ips }}">
        <br>
        <label for="output_file">Output File:</label>
        <input type="text" name="output_file" value="{{ output_file }}">
        <br>
        <button type="submit">Scan</button>
    </form>

    {% if error_message %}
        <p style="color: red;">{{ error_message }}</p>
    {% endif %}

    {% if results %}
        <h2>Results</h2>
        <ul>
            {% for result in results %}
                <li>
                    IP: {{ result.IP }}, MAC: {{ result.MAC }}, Vendor: {{ result.Vendor }}
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <h4>No live hosts</h4>
    {% endif %}
</main>
{%endblock%}